/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.0-beta.98
 */
import{f as t,g as i,t as s}from"./p-0d071f85.js";import{g as n}from"./p-e0437ddc.js";import{d as e}from"./p-98d174f0.js";import{h as a,H as o}from"./p-452677fb.js";const r={heading:"heading",container:"container",indented:"container--indented"},c={parentItem:"parent-item"},l=3;function h(){this.setUpItems(),this.setUpFilter(),this.deselectRemovedItems()}const u=["ArrowUp","ArrowDown"];function d(){this.setUpItems(),this.setUpFilter(),this.emitCalciteListChange=e(x.bind(this),0)}function f(){var e;null===(e=this.mutationObserver)||void 0===e||e.observe(this.el,{childList:!0,subtree:!0})}function m(){var e;null===(e=this.mutationObserver)||void 0===e||e.disconnect()}function p(e){const{selectedValues:s}=this,{item:i,value:a,selected:l,shiftPressed:n}=e.detail;l?(this.multiple&&n&&this.selectSiblings(i),this.multiple||this.deselectSiblingItems(i),s.set(a,i)):(s.delete(a),this.multiple&&n&&this.selectSiblings(i,!0)),this.multiple||(C(i,l),l&&t(i)),this.lastSelectedItem=i,this.emitCalciteListChange()}function v(e){const t=e.detail.oldValue,s=this.selectedValues;if(s.has(t)){const i=s.get(t);s.delete(t),s.set(e.detail.newValue,i)}e.stopPropagation()}function g(e){const{el:t,items:s,multiple:i,selectedValues:a}=this;i||t.contains(e.relatedTarget)||F(s).forEach((t=>{C(t,0===a.size?t.contains(e.target)||e.target===t:t.selected)}))}function b(e){const{key:s,target:i}=e;if(!function(e){return!!u.find((t=>t===e))}(s))return;const{items:a,multiple:l,selectionFollowsFocus:n}=this,{length:c}=a,r=a.indexOf(i);if(!c||-1===r)return;e.preventDefault();const o=a[w(this,i,"ArrowUp"===s?"up":"down")];a.forEach((e=>C(e,e===o))),!l&&n&&(o.selected=!0),t(o)}function w(e,t,s){const{items:i}=e,{length:a}=i,l=i.indexOf(t),c="up"===s?-1:1;let r=1,o=n(l+c*r++,a);const d=o;for(;i[o].disabled&&(o=n(l+c*r++,a),o!==d););return o}function A(e,t){const{items:s}=e;return s.indexOf(t)}function F(e){return e.filter((e=>!e.disabled))}function x(){this.calciteListChange.emit(this.selectedValues)}function y(e){if(e.defaultPrevented)return;const t=e.target,s=this.selectedValues;"CALCITE-PICK-LIST-GROUP"===t.parentElement.tagName&&t.slot===c.parentItem?(t.parentElement.remove(),Array.from(t.parentElement.children).forEach((e=>s.delete(e.value)))):(t.remove(),s.delete(t.value)),this.emitCalciteListChange()}function C(e,t){e.disabled||(t?e.removeAttribute("tabindex"):e.setAttribute("tabindex","-1"))}async function E(e){var s;if(this.filterEnabled&&"filter"===e)return void await t(this.filterEl);const{items:i,multiple:a,selectionFollowsFocus:l}=this;if(0===i.length)return;if(a)return null===(s=F(i)[0])||void 0===s?void 0:s.setFocus();const n=F(i),c=n.find((e=>e.selected))||n[0];return l&&c&&(c.selected=!0),c.setFocus()}function k(e){this.items=Array.from(this.el.querySelectorAll(e));let t=!1;const{items:s}=this;s.forEach((e=>{e.icon=this.getIconType(),this.multiple||(e.disableDeselect=!0,C(e,!1)),e.selected&&(t=!0,C(e,!0),this.selectedValues.set(e.value,e))}));const[i]=s;t||!i||i.disabled||C(i,!0)}function I(){const e=this.selectedValues,t=this.items.map((({value:e})=>e));e.forEach((e=>{t.includes(e.value)||this.selectedValues.delete(e.value)}))}function j(e){this.items.forEach((t=>{t.value!==e.value&&(t.toggleSelected(!1),this.selectedValues.has(t.value)&&this.selectedValues.delete(t.value))}))}function S(e,t=!1){if(!this.lastSelectedItem)return;const{items:s}=this,i=s.findIndex((e=>e.value===this.lastSelectedItem.value)),a=s.findIndex((t=>t.value===e.value));s.slice(Math.min(i,a),Math.max(i,a)).forEach((e=>{e.toggleSelected(!t),t?this.selectedValues.delete(e.value):this.selectedValues.set(e.value,e)}))}let L;function P(e){const{filteredItems:t}=e.currentTarget,s=t.map((e=>e.value));let a=!1;L||(L=new Set);const l=this.items.filter((e=>{const t=e.parentElement;t.matches("calcite-pick-list-group")&&L.add(t);const i=s.includes(e.value);return e.hidden=!i,a||(a=i&&e.selected),i}));L.forEach((e=>{const t=l.some((t=>e.contains(t)));if(e.hidden=!t,!t)return;const s=i(e,"parent-item");s&&(s.hidden=!1,l.includes(s)&&Array.from(e.children).forEach((e=>e.hidden=!1)))})),L.clear(),l.length>0&&!a&&!this.multiple&&C(l[0],!0)}function T(){return this.items.map((e=>({label:e.label,description:e.description,metadata:e.metadata,value:e.value})))}var U;!function(e){e.circle="circle",e.square="square",e.grip="grip"}(U||(U={}));const q=({props:{disabled:e,loading:t,filterEnabled:i,dataForFilter:l,handleFilter:n,filterPlaceholder:c,setFilterEl:r,dragEnabled:d,storeAssistiveEl:u},...h})=>{const m=a("slot",null);return a(o,{"aria-busy":s(t),role:"menu",...h},a("section",null,d?a("span",{"aria-live":"assertive",class:"assistive-text",ref:u}):null,a("header",{class:{"sticky-pos":!0}},i?a("calcite-filter",{"aria-label":c,disabled:t||e,items:l,onCalciteFilterChange:n,placeholder:c,ref:r}):null,a("slot",{name:"menu-actions"})),t?a("calcite-scrim",{loading:t}):null,m))},D={actions:"actions",actionsEnd:"actions--end",actionsStart:"actions--start",description:"description",handle:"handle",handleActivated:"handle--activated",highlight:"highlight",icon:"icon",iconDot:"icon-dot",label:"label",remove:"remove",title:"title",textContainer:"text-container"},H={checked:"check",remove:"x"},M={actionsEnd:"actions-end",actionsStart:"actions-start"},R={remove:"Remove"};export{D as C,l as H,U as I,q as L,M as S,R as T,j as a,T as b,w as c,I as d,f as e,m as f,A as g,P as h,d as i,g as j,b as k,p as l,h as m,v as n,k as o,E as p,c as q,y as r,S as s,r as t,H as u};